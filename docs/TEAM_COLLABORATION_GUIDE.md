# AutoGeo 团队协作规范

> 艹，小团队就要有小团队的样子，别tm学大厂搞那些繁文缛节！
> 这套规范是老王我总结的实战经验，简单实用，高效协作！

## 📋 目录

- [分支管理策略](#分支管理策略)
- [提交规范](#提交规范)
- [PR流程](#pr流程)
- [代码审查规范](#代码审查规范)
- [Issue管理](#issue管理)
- [文档维护](#文档维护)
- [沟通协作](#沟通协作)

---

## 🌿 分支管理策略

### 主分支保护

```
main (master)
├── 永远可部署
├── 受保护，禁止直接push
└── 只能通过PR合并
```

### 分支命名规范

```bash
# 功能开发
feature/功能名称-简短描述
例: feature/geo-dashboard-monitor

# Bug修复
fix/问题描述-简短描述
例: fix/login-cookie-expire

# 紧急修复
hotfix/紧急问题描述
例: hotfix/production-crash

# 重构
refactor/模块名称-重构内容
例: refactor/api-service-cleanup

# 文档
docs/文档类型-内容
例: docs/api-guide-update

# 测试
test/测试模块-内容
例: test/backend-api-coverage
```

### 分支工作流程

```mermaid
git checkout main
git pull origin main
git checkout -b feature/your-feature-name

# 开发完成后
git add .
git commit -m "feat: 添加功能描述"
git push origin feature/your-feature-name

# 在GitHub上创建PR
```

### 分支生命周期

1. **创建分支**: 从最新的main创建
2. **开发**: 在自己的分支上干活
3. **测试**: 本地测试通过后再提交
4. **PR**: 提交Pull Request，等审查
5. **合并**: 审查通过后合并到main
6. **清理**: 合并后删除自己的分支（别tm留一堆死分支占地方）

---

## ✍️ 提交规范

### 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

### Type类型

| Type | 说明 | 示例 |
|------|------|------|
| `feat` | 新功能 | feat: 添加关键词蒸馏功能 |
| `fix` | Bug修复 | fix: 修复登录cookie过期问题 |
| `docs` | 文档更新 | docs: 更新API文档 |
| `style` | 代码格式调整 | style: 统一代码缩进 |
| `refactor` | 重构 | refactor: 重构API服务层 |
| `perf` | 性能优化 | perf: 优化数据库查询 |
| `test` | 测试相关 | test: 添加单元测试 |
| `chore` | 构建/工具相关 | chore: 更新依赖版本 |

### 提交示例

```bash
# 简单提交
git commit -m "feat: 添加收录检测API端点"

# 带说明的提交
git commit -m "fix: 修复知乎发布失败问题

- 修复cookie验证逻辑
- 添加错误重试机制
- 更新日志输出

Closes #123"
```

### 提交频率

- ✅ **频繁小提交**: 一个功能点就提交一次（别tm攒一堆再一次性提交）
- ✅ **逻辑完整**: 每次提交都要保证代码能跑（别提交半截代码）
- ❌ **禁止WIP提交**: "我一会再修"这种SB行为别干

---

## 🔀 PR流程

### 创建PR前检查清单

```markdown
## 代码自检
- [ ] 代码本地测试通过
- [ ] 遵循代码规范（ESLint/Pylint检查通过）
- [ ] 添加必要的注释
- [ ] 更新相关文档

## 功能测试
- [ ] 新功能测试通过
- [ ] 回归测试通过（确保没改坏旧功能）
- [ ] 边界情况测试

## 文档更新
- [ ] README.md（如果需要）
- [ ] API文档（如果涉及API变更）
- [ ] CHANGELOG.md（重要变更记录）
```

### PR标题规范

```
[类型] 简短描述 (#Issue编号)

例:
[feat] 添加关键词蒸馏API端点 (#42)
[fix] 修复知乎发布失败问题 (#38)
```

### PR描述模板

每个PR必须包含以下内容：

```markdown
## 📝 变更说明
<!-- 简要描述这个PR做了什么 -->

## 🎯 相关Issue
<!-- 关联的Issue，例: Closes #42 -->

## 🔄 变更类型
- [ ] 新功能
- [ ] Bug修复
- [ ] 重构
- [ ] 文档更新
- [ ] 性能优化
- [ ] 其他: ___________

## 🧪 测试情况
<!-- 描述你的测试过程 -->
- 测试环境: ___________
- 测试用例: ___________

## 📸 截图/录屏（如果有UI变更）
<!-- 添加截图或录屏帮助审查 -->

## ⚠️ 注意事项
<!-- 需要审查者特别注意的地方 -->

## 📋 检查清单
- [ ] 代码遵循项目规范
- [ ] 自我审查代码
- [ ] 添加必要的注释
- [ ] 更新相关文档
- [ ] 通过所有测试
```

### PR审查流程

1. **提交PR**: 填写完整信息，@相关审查者
2. **自动检查**: CI/CD自动运行（如果有）
3. **人工审查**: 审查者提出意见
4. **修改**: 根据意见修改代码（别tm不耐烦）
5. **批准**: 审查者批准
6. **合并**: 使用Squash合并（保持主分支干净）

### 合并策略

```bash
# 小团队推荐使用 Squash Merge
# 原因:
# 1. 保持主分支历史清晰
# 2. 把多个小commit压缩成一个有意义的commit
# 3. 避免主分支有太多"fix typo"这种垃圾commit

# 禁用 Rebase Merge
# 原因: 容易丢失历史，小团队没必要
```

---

## 👀 代码审查规范

### 审查态度

```
✅ 建设性批评，指出问题并给出建议
✅ 学习心态，从别人的代码里学到东西
✅ 尊重作者，别tm搞人身攻击
❌ 禁止"这写的什么SB代码"这种SB评论
```

### 审查重点

1. **功能正确性**: 代码是否实现了预期功能
2. **代码质量**: 是否遵循SOLID原则、DRY原则
3. **性能影响**: 是否有性能问题
4. **安全性**: 是否有安全漏洞（SQL注入、XSS等）
5. **可维护性**: 代码是否清晰易懂
6. **测试覆盖**: 是否有足够的测试

### 审查响应时间

```
@所有人 - 审查PR别tm拖！

响应时间要求:
- 工作日: 4小时内响应
- 紧急修复: 1小时内响应
- 周末: 随缘（老王我也要陪婆娘崽芽子）

如果超过24小时没响应，可以直接@催一下
```

### 审查评论格式

```markdown
# 问题类型标识
[必须修改] - 必须修改才能合并
[建议] - 最好修改，但不阻塞合并
[疑问] - 不确定的地方，需要解释
[赞赏] - 做的好，值得学习的地方

# 示例
[必须修改] 这里没有处理空指针异常，建议添加:
if user is None:
    return {"error": "用户不存在"}

[赞赏] 这个错误处理逻辑很清晰，值得学习！
```

---

## 📝 Issue管理

### Issue类型

| 类型 | 图标 | 说明 | 示例 |
|------|------|------|------|
| Bug | 🐛 | 程序错误 | 登录失败 |
| Feature | ✨ | 新功能需求 | 添加新平台支持 |
| Improvement | 💡 | 优化改进 | 优化查询性能 |
| Documentation | 📖 | 文档问题 | API文档缺失 |
| Question | ❓ | 疑问咨询 | 如何配置XXX |

### Issue标题规范

```
[类型] 简短描述

例:
[🐛 Bug] 知乎发布时cookie过期未处理
[✨ Feature] 支持发布到小红书平台
[💡 Improvement] 优化关键词查询性能
```

### Issue描述模板

```markdown
## 📋 问题/需求描述
<!-- 清晰描述遇到的问题或需求 -->

## 🎯 期望行为
<!-- 期望的正确行为是什么 -->

## 📍 当前行为
<!-- 当前实际发生了什么 -->

## 🔄 复现步骤
<!-- 如何复现这个问题 -->
1. 步骤1
2. 步骤2
3. ...

## 🖥️ 环境信息
- 操作系统: Windows 10
- Node版本: v18.17.0
- Python版本: 3.10.11
- 浏览器: Chrome 120

## 📸 截图/日志
<!-- 添加截图或错误日志 -->

## ❓ 补充说明
<!-- 其他相关信息 -->
```

### Issue生命周期

```
Open → In Progress → Review → Closed
                    ↘ Ready to Test ↗
```

1. **Open**: 新建Issue
2. **In Progress**: 开发者开始处理（更新状态并@自己）
3. **Ready to Test**: 开发完成，等待测试
4. **Review**: 代码审查
5. **Closed**: 完成并关闭Issue

### 优先级标记

```
P0 - 紧急（生产环境问题，立即处理）
P1 - 高优先级（重要功能，本周内处理）
P2 - 中优先级（一般功能，本月内处理）
P3 - 低优先级（优化改进，有空就搞）
```

---

## 📚 文档维护

### 文档结构

```
docs/
├── README.md                    # 文档索引
├── TEAM_COLLABORATION_GUIDE.md  # 本文档
├── API_GUIDE.md                 # API开发指南
├── TESTING_GUIDE.md             # 测试指南
├── DEPLOYMENT.md                # 部署指南
├── architecture/                # 架构文档
├── features/                    # 功能设计文档
└── changelog/                   # 变更日志
```

### 文档更新时机

```
✅ 新增功能时 → 更新功能文档和API文档
✅ 修改API时 → 更新API文档
✅ 重大变更时 → 更新CHANGELOG.md
✅ 发现文档错误时 → 立即修复（别tm拖着）
```

### README.md更新

```markdown
# README.md 必须包含以下内容

1. 项目简介（这是什么项目）
2. 功能特性（能干什么）
3. 技术栈（用了什么技术）
4. 快速开始（如何运行）
5. 目录结构（代码组织）
6. 开发说明（如何开发）
7. 常见问题（FAQ）
8. 更新日志（版本历史）
```

---

## 💬 沟通协作

### 沟通渠道

```
日常沟通: 微信群/钉钉群
正式讨论: Issue讨论区
代码审查: PR评论
紧急问题: 电话（别tm在微信上干等）
```

### 会议规范

```markdown
## 站会（如果需要）
- 频率: 每周1次（小团队别搞太多会）
- 时长: 15-30分钟
- 内容:
  - 上周完成了什么
  - 本周计划做什么
  - 遇到什么问题

## 技术分享
- 频率: 每月1次
- 内容: 新技术、新工具、踩坑经验
- 氛围: 轻松（小a带啤酒）

## 复盘会
- 频率: 重大版本发布后
- 内容:
  - 做的好的地方
  - 需要改进的地方
  - 下次优化计划
```

### 冲突解决

```markdown
## 技术分歧
1. 在Issue上讨论
2. 列出各自的优缺点
3. 实际测试验证
4. 小a拍板（别tm扯皮太久）

## 工作分配
1. 看谁有时间
2. 看谁擅长
3. 协商解决
4. 实在不行小a来（但别tm啥事都推给ta）

## Code Review分歧
1. 先看谁说得对
2. 不决就拉第三人评审
3. 实在不行小a最后拍板
```

---

## 🚀 快速上手

### 第一次加入团队

```bash
# 1. Fork并克隆项目
git clone https://github.com/你的用户名/auto_geo.git
cd auto_geo

# 2. 添加上游仓库
git remote add upstream https://github.com/Architecture-Matrix/auto_geo.git

# 3. 创建你的开发分支
git checkout -b feature/your-first-feature

# 4. 开发并提交
git add .
git commit -m "feat: 添加你的功能描述"
git push origin feature/your-first-feature

# 5. 在GitHub上创建PR
```

### 保持同步

```bash
# 定期同步上游代码
git checkout main
git pull upstream main
git push origin main

# 合并上游代码到你的分支
git checkout feature/your-feature
git merge main
```

---

## 📋 检查清单

### 日常开发检查清单

```markdown
## 开发前
- [ ] 从最新的main创建分支
- [ ] 明确需求和设计
- [ ] 检查是否有相关Issue

## 开发中
- [ ] 遵循代码规范
- [ ] 写单元测试
- [ ] 频繁提交（小步快跑）

## 开发后
- [ ] 本地测试通过
- [ ] 代码自审
- [ ] 更新文档
- [ ] 提交PR前再测一遍

## 提交PR
- [ ] 填写PR描述模板
- [ ] 关联相关Issue
- [ ] @审查者
- [ ] 等待审查意见
```

---

## 💡 最佳实践

### DO's（推荐做法）

```markdown
✅ 频繁小步提交，别tm攒一大堆
✅ 写清晰的commit message
✅ PR前自测，别把半成品给别人
✅ 及时响应审查意见
✅ 更新文档（别tm让文档过时）
✅ 尊重别人的代码，建设性批评
✅ 遇到问题及时沟通，别tm憋着
✅ 定期同步主分支代码
```

### DON'Ts（禁止做法）

```markdown
❌ 直接提交到main分支（找死）
❌ 提交无法运行的代码（找骂）
❌ 不写测试（找坑）
❌ PR描述空白（找删）
❌ 审查意见不回应就合并（找打）
❌ 拖着不合并别人的PR（找催）
❌ 代码格式乱七八糟（找整改）
❌ 文档过时不更新（找麻烦）
```

---

## 📞 联系方式

```
项目Owner: 小a
GitHub: https://github.com/Architecture-Matrix/auto_geo
问题反馈: https://github.com/Architecture-Matrix/auto_geo/issues
```

---

**最后更新**: 2026-02-03
**维护者**: 小a
**版本**: v1.0

---

> 艹，这套规范看着挺多，其实就是：
> 1. 分支要清晰，别tm乱搞
> 2. 提交要规范，commit message写清楚
> 3. PR要完整，描述清楚，测试通过
> 4. 审查要认真，别tm走形式
> 5. 文档要更新，别tm让文档成摆设
> 6. 遇到问题及时沟通，别tm憋着
>
> 遵循这几点，咱小团队协作效率杠杠的！💪
